---
layout: post
title: openflow一些脚本
time: 2011-09-09 11:04
tags: 好好学习天天向上
---

<div id=content class="content mod-cs-content text-content clearfix"> <p><br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace all 10 dl_type=0x0806 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace all 10 dl_type=0x0806 Slice:slice2=4<br /><br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=1,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=1,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=2,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=2,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=2,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=2,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=3,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=3,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=1,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=1,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=2,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=2,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=1,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=1,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=3,dl_type=0x0800,tp_src=8003 Slice:slice1=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=3,dl_type=0x0800,tp_dst=8003 Slice:slice1=4<br /><br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=1,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=2,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=2,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=3,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=1,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=2,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=1,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=3,dl_type=0x0800,tp_src=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=1,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000001 10 in_port=2,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=2,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000002 10 in_port=3,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=1,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000003 10 in_port=2,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=1,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />&nbsp; fvctl --passwd-file=pass.txt addFlowSpace 0000000000000004 10 in_port=3,dl_type=0x0800,tp_dst=8004 Slice:slice2=4<br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~addFlowSpace.sh</p>fvctl createSlice slice1 tcp:59.64.159.134:3366 junlong666@gmail.com<br />fvctl createSlice slice2 tcp:59.64.158.183:3366 junlong666@gmail.com<br /><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~createSlice.sh</p><p>flowvisor -l /usr/local/etc/flowvisor/config.xml 2&gt;&amp;1</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~flowvisor.sh</p><p>sudo mn --custom s11.py --topo mytopo --mac</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~mn.sh</p>&quot;&quot;&quot;Custom topology example<br /><br />author: Brandon Heller (brandonh@stanford.edu)<br /><br />Two directly connected switches plus a host for each switch:<br /><br />&nbsp;&nbsp; host --- switch --- switch --- host<br /><br />Adding the 'topos' dict with a key/value pair to generate our newly defined<br />topology enables one to pass in '--topo=mytopo' from the command line.<br />&quot;&quot;&quot;<br /><br />from mininet.topo import Topo, Node<br /><br />class MyTopo( Topo ):<br />&nbsp;&nbsp;&nbsp; &quot;Simple topology example.&quot;<br /><br />&nbsp;&nbsp;&nbsp; def __init__( self, enable_all = True ):<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Create custom topo.&quot;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Add default members to class.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; super( MyTopo, self ).__init__()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Set Node IDs for hosts and switches<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; leftHost = 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; leftSwitch = 2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rightSwitch = 3<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rightHost = 4<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Add nodes<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.add_node( leftSwitch, Node( is_switch=True ) )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.add_node( rightSwitch, Node( is_switch=True ) )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.add_node( leftHost, Node( is_switch=False ) )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.add_node( rightHost, Node( is_switch=False ) )<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Add edges<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.add_edge( leftHost, leftSwitch )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.add_edge( leftSwitch, rightSwitch )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.add_edge( rightSwitch, rightHost )<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Consider all switches and hosts 'on'<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self.enable_all()<br /><br /><br /><p>topos = { 'mytopo': ( lambda: MyTopo() ) }</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~`mytopo.py</p><p>cd /home/openflow/noxcore/build/src/<br />./nox_core -v -i ptcp:6633</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~nox.sh</p><p>ofdatapath punix:/var/run/dp1 -d 000000000001 -i $1</p><p>ofdatapath punix:/var/run/dp2 -d 000000000002 -i $1</p><p>ofdatapath punix:/var/run/dp0 -d 004E46324304 -i $1</p><p>ofdatapath punix:/var/run/dp1 -d 004E46324306 -i $1</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ofdatapath.sh</p><p>ofprotocol unix:/var/run/dp1 tcp:127.0.0.1:6633<br />ofprotocol unix:/var/run/dp2 tcp:127.0.0.1:6633<br />ofprotocol unix:/var/run/dp0 tcp:127.0.0.1:6633<br />ofprotocol unix:/var/run/dp1 tcp:127.0.0.1:6633<br />~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ofprotocol.sh</p><p>&quot;&quot;&quot;Custom topology example<br /><br />author: Brandon Heller (brandonh@stanford.edu)<br /><br />&nbsp;&nbsp; &nbsp;Two directly connected switches plus a host for each switch:<br /><br />&nbsp;&nbsp; &nbsp;host --- switch --- switch --- host<br /><br />&nbsp;&nbsp; &nbsp;Adding the 'topos' dict with a key/value pair to generate our newly defined<br />&nbsp;&nbsp; &nbsp;topology enables one to pass in '--topo=mytopo' from the command line.<br />&nbsp;&nbsp; &nbsp;&quot;&quot;&quot;<br /><br />from mininet.topo import Topo, Node<br /><br />class MyTopo( Topo ):<br />&nbsp;&nbsp; &nbsp;&quot;Simple topology example.&quot;<br /><br />&nbsp;&nbsp; &nbsp;def __init__( self, enable_all = True ):<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&quot;Create custom topo.&quot;<br /><br /># Add default members to class.<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;super( MyTopo, self ).__init__()<br /><br />&nbsp;&nbsp; &nbsp;# Set Node IDs for hosts and switches<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;leftHost = 33<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;rightHost = 44<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;ER1 = 1<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;ER2 = 2<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;ER3 = 3<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;CR1 = 4<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;CR2 = 5<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;CR3 = 6<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;MR1 = 7<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;MR2 = 8<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;R1 = 9<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;R2 = 10<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;R3 = 11<br /><br />&nbsp;&nbsp; &nbsp;# Add nodes<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( ER1, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( ER2, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( ER3, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( CR1, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( CR2, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( CR3, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( MR1, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( MR2, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( R1, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( R2, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( R3, Node( is_switch=True ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( leftHost, Node( is_switch=False ) )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_node( rightHost, Node( is_switch=False ) )<br /><br />&nbsp;&nbsp; &nbsp;# Add edges<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( leftHost, ER3 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( rightHost, ER1 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( MR1, CR1 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( MR2, CR1 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( MR2, ER1 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( MR1, CR2 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( CR2, CR3 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( CR3, ER1 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( ER3, CR2 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( R1, CR2 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( CR3, R3 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( CR3, ER2 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( ER3, R2 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( ER2, R3 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( R1, R2 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( R1, R3 )<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.add_edge( R2, R3 )<br /><br />&nbsp;&nbsp; &nbsp;# Consider all switches and hosts 'on'<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;self.enable_all()<br /><br /><br />topos = { 'mytopo': ( lambda: MyTopo() ) }</p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~`s11.py</p> </div>