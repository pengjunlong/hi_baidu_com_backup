---
layout: post
title: 百度搜索建议分析之bdsug.js部分6
time: 2011-04-28 15:11
tags: 好好学习天天向上
---

<div id=content class="content mod-cs-content text-content clearfix"> <p>505&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baidu.sug&nbsp;=&nbsp;function(C)&nbsp;{&nbsp;baidu.dm({&nbsp;type:&nbsp;&quot;response_data&quot;,&nbsp;data:&nbsp;C&nbsp;})&nbsp;};<br />506&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baidu.initSug&nbsp;=&nbsp;function()&nbsp;{&nbsp;baidu.dm({&nbsp;type:&nbsp;&quot;init&quot;&nbsp;})&nbsp;};<br />507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I.ini(baidu);<br />508&nbsp;<br />509&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//cookie管理<br />510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;D&nbsp;=&nbsp;(function()&nbsp;{<br />511&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;C()&nbsp;{<br />512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(navigator.cookieEnabled)&nbsp;{<br />513&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.cookie&nbsp;=&nbsp;&quot;su=0;&nbsp;domain=www.baidu.com&quot;<br />514&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />515&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />516&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;G()&nbsp;{<br />517&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;U&nbsp;=&nbsp;(navigator.cookieEnabled&nbsp;&amp;&amp;&nbsp;/sug=(\d)/.test(document.cookie)&nbsp;?&nbsp;RegExp.$1&nbsp;:&nbsp;3);<br />518&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D.dm({&nbsp;type:&nbsp;&quot;give_cookie&quot;,&nbsp;sug:&nbsp;U&nbsp;})<br />519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />520&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;I.ini({&nbsp;rm:&nbsp;function(U)&nbsp;{<br />521&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(U.type)&nbsp;{<br />522&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&quot;close&quot;:&nbsp;C();&nbsp;break;<br />523&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&quot;need_cookie&quot;:&nbsp;G();&nbsp;break<br />524&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />525&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />526&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br />527&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})();<br />528&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//百度suggestion&nbsp;显示管理<br />529&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;B&nbsp;=&nbsp;(function()&nbsp;{<br />530&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//input&nbsp;id=kw&nbsp;name=wd<br />531&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;W&nbsp;=&nbsp;H(&quot;kw&quot;);<br />532&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//div&nbsp;id=sd_1274332392357<br />533&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;C;<br />534&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Form<br />535&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;Z&nbsp;=&nbsp;document.forms[0];<br />536&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//<br />537&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;V;<br />538&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//<br />539&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;X()&nbsp;{<br />540&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(C.offsetWidth&nbsp;!=&nbsp;0&nbsp;&amp;&amp;&nbsp;W.offsetWidth&nbsp;!=&nbsp;C.offsetWidth)&nbsp;{<br />541&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.dm({&nbsp;type:&nbsp;&quot;need_resize&quot;&nbsp;})<br />542&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />543&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />544&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//插入iframe<br />545&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;a()&nbsp;{<br />546&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;=&nbsp;J(&quot;DIV&quot;);<br />547&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.id&nbsp;=&nbsp;&quot;sd_&quot;&nbsp;+&nbsp;new&nbsp;Date().getTime();<br />548&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.style.display&nbsp;=&nbsp;&quot;none&quot;;<br />549&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Z.appendChild(C);<br />550&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(L)&nbsp;{<br />551&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V&nbsp;=&nbsp;J(&quot;IFRAME&quot;);&nbsp;V.style.display&nbsp;=&nbsp;&quot;none&quot;;&nbsp;V.style.position&nbsp;=&nbsp;&quot;absolute&quot;;<br />552&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C.parentNode.insertBefore(V,&nbsp;C)<br />553&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />554&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />555&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;Y(b)&nbsp;{<br />556&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;b&nbsp;||&nbsp;window.event;<br />557&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c&nbsp;=&nbsp;b.target&nbsp;||&nbsp;b.srcElement;<br />558&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(c&nbsp;==&nbsp;W)&nbsp;{&nbsp;return&nbsp;}<br />559&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(c&nbsp;=&nbsp;c.parentNode)&nbsp;{<br />560&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(c&nbsp;==&nbsp;C)&nbsp;{&nbsp;return&nbsp;}<br />561&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />562&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.dm({&nbsp;type:&nbsp;&quot;mousedown_other&quot;&nbsp;})<br />563&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />564&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;U()&nbsp;{<br />565&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.dm({&nbsp;type:&nbsp;&quot;window_blur&quot;&nbsp;})<br />566&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />567&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//<br />568&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;G()&nbsp;{<br />569&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.dm({&nbsp;type:&nbsp;&quot;div_ready&quot;,&nbsp;sdiv:&nbsp;C,&nbsp;frm:&nbsp;V&nbsp;});<br />570&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//页面onmousedown事件处理程序<br />571&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setInterval(X,&nbsp;100);&nbsp;O(document,&nbsp;&quot;mousedown&quot;,&nbsp;Y);<br />572&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//窗口onblur事件处理程序<br />573&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O(window,&nbsp;&quot;blur&quot;,&nbsp;U);<br />574&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//以下代码动态添加&lt;style&gt;标签的内容<br />575&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//C.id&nbsp;&lt;DIV&nbsp;style=&quot;DISPLAY:&nbsp;none&quot;&nbsp;id=&quot;sd_1274422507294&quot;&gt;&nbsp;其中sd_1274422507294中的数字是new&nbsp;Date().getTime();<br />576&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(&quot;#&quot;&nbsp;+&nbsp;C.id,&nbsp;&quot;border:1px&nbsp;solid&nbsp;#817F82;position:absolute;top:28px;left:0&quot;);<br />577&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(&quot;#&quot;&nbsp;+&nbsp;C.id&nbsp;+&nbsp;&quot;&nbsp;table&quot;,&nbsp;&quot;width:100%;background:#fff;cursor:default&quot;);<br />578&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(&quot;#&quot;&nbsp;+&nbsp;C.id&nbsp;+&nbsp;&quot;&nbsp;td&quot;,&nbsp;&quot;font:14px&nbsp;verdana&quot;);<br />579&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//<br />580&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(&quot;.mo&quot;,&nbsp;&quot;background-color:#36c;color:#fff&quot;);<br />581&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P(&quot;.ml&quot;,&nbsp;&quot;background-color:#fff;color:#000&quot;)<br />582&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />583&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baidu.sug.initial&nbsp;=&nbsp;G;<br />584&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;I.ini({&nbsp;rm:&nbsp;function(b)&nbsp;{<br />585&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(b.type)&nbsp;{<br />586&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&quot;start&quot;:&nbsp;G();&nbsp;break;<br />587&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&quot;init&quot;:&nbsp;a();&nbsp;break<br />588&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />589&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />590&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})<br />591&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})();<br />592&nbsp;<br />593&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.on(&quot;need_data&quot;,&nbsp;A);<br />594&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.on(&quot;close_div&quot;,&nbsp;T);<br />595&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.on(&quot;key_enter&quot;,&nbsp;T);<br />596&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.on(&quot;key_up&quot;,&nbsp;T);<br />597&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.on(&quot;key_down&quot;,&nbsp;T);<br />598&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.on(&quot;hide_div&quot;,&nbsp;T);<br />599&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E.on(&quot;start&quot;,&nbsp;B);<br />600&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.on(&quot;request_data&quot;,&nbsp;Q);<br />601&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.on(&quot;give_data&quot;,&nbsp;T);<br />602&nbsp;<br />603&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baidu.on(&quot;response_data&quot;,&nbsp;A);<br />604&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baidu.on(&quot;init&quot;,&nbsp;B);<br />605&nbsp;<br />606&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T.on(&quot;clk_submit&quot;,&nbsp;E,&nbsp;R);<br />607&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T.on(&quot;ent_submit&quot;,&nbsp;E,&nbsp;R);<br />608&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T.on(&quot;submit&quot;,&nbsp;R);<br />609&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T.on(&quot;key_select&quot;,&nbsp;E);<br />610&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T.on(&quot;close&quot;,&nbsp;E,&nbsp;D);<br />611&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T.on(&quot;mousedown_tr&quot;,&nbsp;E);<br />612&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.on(&quot;mousedown_other&quot;,&nbsp;T);<br />613&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.on(&quot;need_resize&quot;,&nbsp;T);<br />614&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.on(&quot;div_ready&quot;,&nbsp;E,&nbsp;T);<br />615&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B.on(&quot;window_blur&quot;,&nbsp;T);<br />616&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q.on(&quot;need_cookie&quot;,&nbsp;D);<br />617&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D.on(&quot;give_cookie&quot;,&nbsp;Q);<br />618&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.baidu.initSug()<br />619&nbsp;})();<br />620 </p> </div>