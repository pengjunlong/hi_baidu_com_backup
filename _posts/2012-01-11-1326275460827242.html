---
layout: post
title: OpenFlow网络环境搭建小记
time: 2012-01-11 17:51
keywords: 好好学习天天向上
---
<div id=content class="content mod-cs-content text-content clearfix"> <p>1.安装switch</p><p>http://www.openflow.org/wp/deploy-labsetup/#3_1_1_Stanford_Software_Referenc</p>Step1. Download Software $ git clone git://gitosis.stanford.edu/openflow.git $ cd openflow $ git checkout -b openflow.v1.0 origin/release/1.0.0<a name="Step2_Compile"></a> Step2. Compile $ ./boot.sh $ ./configure $ make<p># ./udatapath/ofdatapath --detach punix:/var/run/dp0 -d 004E46324304 -i eth1,eth2</p><p></p><p></p># ./secchan/ofprotocol unix:/var/run/dp0 tcp:192.168.0.100:6633<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>2.安装Controller</p><p>http://noxrepo.org/noxwiki/index.php/NOX_Installation</p>git clone git://noxrepo.org/nox   cd nox ./boot.sh   mkdir build/   cd build/   ../configure   make -j 5 cd src/   ./nox_core -h<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>3.安装FlowVisor</p><p>&nbsp;https://openflow.stanford.edu/display/DOCS/Flowvisor</p>Install from Source<p>Install ant and java in order to build flowvisor:</p>apt-get -y install ant sun-java6-jdk<p>Now build it:</p>make CFLAGS=&quot;-I/usr/lib/jvm/java-6-sun/include -I/usr/lib/jvm/java-6-sun/include/linux&quot;<p>(FlowVisor also works with openjdk, but you will have to adjust the commands accordingly)</p><p>If the build ends with BUILD SUCCESSFUL then install flowvisor (run as root if installing to /usr/local):</p>make install<p>When prompted, set the prefix to <tt>/usr/local</tt> and the user/group to the user/group you want the flowvisor to run as.  Next, generate a default configuration file with:</p>fvconfig generate /usr/local/etc/flowvisor/flowvisor-config.xml<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>4.安装Mininet</p><p>http://yuba.stanford.edu/foswiki/bin/view/OpenFlow/MininetGettingStarted</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>5.安装OMNI</p><p>http://www.gta.ufrj.br/omni/index.php?option=com_content&amp;view=article&amp;id=34&amp;Itemid=28</p>			Integration	<hr /><p>To run OMNI, you must have every piece configured with the others. This guide will help you configure you system to run OMNI.</p>Starting FlowVisor<p>First of all, we need to start FlowVisor:</p>flowvisor /usr/local/etc/flowvisor/flowvisor-config.xml<p>&nbsp;</p>Starting NOX<p>After that, we need to start Nox:</p>cd &lt;nox base dir&gt;/build/src<br /><br />./nox_core -v -i ptcp:&lt;controller port&gt; mywebserver<p>&nbsp;</p>Starting OpenFlow<p>Then, we can start the OpenFlow switches. In order to simplify this task, we created an interface tool, called startOpenFlow. Thus, download the tool and copy it to your /usr/bin/ directory, running the following command:</p>wget http://www.gta.ufrj.br/omni/phocadownload/startOpenflow.py<br />chmod +x startOpenflow.py<br />cp startOpenflow.py /usr/bin/<br /><p>&nbsp;</p><p>To run the starting tool (iface 1, ..., iface n are the names of the interfaces which you wish to add to the OpenFlow switch. switch IP is the IP address that should be assigned to the swtich):</p>startOpenflow.py &lt;iface 1&gt;...&lt;iface n&gt; -c &lt;controller IP&gt;:&lt;controller port&gt; -ip &lt;switch IP&gt;<br /><p>&nbsp;</p><p>After starting the OpenFlow process into all switches, your OpenFlow network is already done. The next step is to start the controlling web interface.</p><p>&nbsp;</p><p>&nbsp;</p>Downloading and Configuring Web Interface<p>First, download the Web Interface at our <a href="http://omni/index.php?option=com_phocadownload&amp;view=category&amp;id=3:web-interface&amp;Itemid=17" target="_blank">download page</a>, or following these commands, and unzip it.</p>wget http://www.gta.ufrj.br/omni/phocadownload/web-interface-1-0.tar.gz<br />tar - xzf web-interface.tar.gz<p>&nbsp;</p><p>Now, it is already installed. The only requirements before starting the web interface is to install Graphviz and configure some parameters of the web interface.</p><p>&nbsp;</p><p>Graphviz is the program used by the web interface to draw the topology graph. To install this program, run this command:</p>apt-get install graphviz<br /><p></p><p>&nbsp;</p><p>After that, configure the Web Interface parameters. Open config.xml with the text editor of your choice and change the following parts to your network configuration (in example we use the text editor called nano, but you can use anyone):</p>cd &lt;web interface base directory&gt;<br />nano config.xmlThe text in red must be changed to your network setup:&lt;config&gt;<br />            &lt;port&gt;<strong>web interface listening port</strong>&lt;/port&gt;<br />            &lt;server&gt;<br />                        &lt;name&gt;<strong>controller name OR controller IP address</strong>&lt;/name&gt;<br />                        &lt;port&gt;<strong>controller listening port</strong>&lt;/port&gt;<br />            &lt;/server&gt;<br />&lt;/config&gt;; <p>&nbsp;</p><p>Run the Web Interface Server:</p>python webserver.py<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>6.安装expedient</p><p><a href="http://yuba.stanford.edu/foswiki/bin/view/OpenFlow/Deployment/HOWTO/ProductionSetup/InstallingExpedientOIM">InstallingExpedientOIM &lt; OpenFlow/Deployment/HOWTO/ProductionSetup &lt; Foswiki</a></p><p><a href="http://www.openflow.org/wp/deploy-expedient-oim/">OpenFlow &#187; Deploy Expedient and Opt-in Manager</a></p><p><a href="http://yuba.stanford.edu/foswiki/bin/view/OpenFlow/Deployment/HOWTO/ProductionSetup/InstallingExpedientOIM#Usage_instructions_for_Opt_In_Ma">InstallingExpedientOIM &lt; OpenFlow/Deployment/HOWTO/ProductionSetup &lt; Foswiki</a></p><p><a href="http://www.openflow.org/wk/index.php/GEC8_Demo">GEC8 Demo - OpenFlow Wiki</a></p> </div>