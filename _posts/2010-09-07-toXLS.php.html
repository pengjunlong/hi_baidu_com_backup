tag=好好学习天天向上
<div id=content class="content mod-cs-content text-content clearfix"> &lt;?php<br />require_once 'D:\xampp\php\PEAR\Spreadsheet\Excel\Writer.php';<br />/*****<br />// Creating a workbook<br />$workbook = new Spreadsheet_Excel_Writer();<br /><br />// sending HTTP headers<br />$workbook-&gt;send('test.xls');<br /><br />// Creating a worksheet<br />$worksheet =&amp; $workbook-&gt;addWorksheet('My first worksheet');<br /><br />// The actual data<br />//设置字体大小<br />$format_column = &amp; $workbook-&gt;addformat(array('Size'=&gt;9,'Bold'=&gt;1));<br />//数据写入<br />//标题行(第一行)<br />$worksheet-&gt;write(0, 0, 'Name', $format_column);<br />$worksheet-&gt;write(0, 1, 'Age', $format_column);<br />$worksheet-&gt;write(1, 0, 'John Smith');<br />$worksheet-&gt;write(1, 1, 30);<br />$worksheet-&gt;write(2, 0, 'Johann Schmidt');<br />$worksheet-&gt;write(2, 1, 31);<br />$worksheet-&gt;write(3, 0, 'Juan Herrera');<br />$worksheet-&gt;write(3, 1, 32);<br /><br />// Let's send the file<br />$workbook-&gt;close();<br />***/<br />// 如果文件不存在<br />//if ( !file_exists('iptv.xls') )<br />if(true) {<br /><br />// Include PEAR::Spreadsheet_Excel_Writer<br />//require_once &quot;Spreadsheet/Excel/Writer.php&quot;;<br /><br />// Create an instance, passing the filename to create<br />$xls =&amp; new Spreadsheet_Excel_Writer('iptv.xls');<br /><br />// Add a worksheet to the file, returning an object to add data to<br />$sheet =&amp; $xls-&gt;addWorksheet('myIPTV');<br /><br />$format_column = &amp; $xls-&gt;addformat(array('Size'=&gt;10,'Bold'=&gt;1));<br />$sheet-&gt;write(0, 0, 'URL', $format_column);<br />$sheet-&gt;write(0, 1, 'NAME', $format_column); <br />$sheet-&gt;setColumn(0,0,40);<br />$sheet-&gt;setColumn(1,1,20);<br />// Write<br />$con = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;&quot;);<br />if (!$con)<br />{<br />die('Could not connect: ' . mysql_error());<br />}<br /><br />mysql_select_db(&quot;my_db&quot;, $con);<br /><br />$result = mysql_query(&quot;SELECT * FROM iptv&quot;);<br />for ( $i=1;($row = mysql_fetch_array($result));$i++ ) {<br />// Use PHP's decbin() function to convert integer to binary<br />$sheet-&gt;write($i,0,$row['URL']);<br />$sheet-&gt;write($i,1,$row['NAME']);<br />}<br /><br />// Finish the spreadsheet, dumping it to the browser<br />$xls-&gt;close();<br />}<br />?&gt; </div>