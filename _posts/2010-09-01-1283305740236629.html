---
layout: post
title: toDB.php
time: 2010-09-01 09:49
tags: 好好学习天天向上
---

<div id=content class="content mod-cs-content text-content clearfix"> &lt;?php<br />/*<br />* Created on 2010-8-31<br />*<br />* To change the template for this generated file go to<br />* Window - Preferences - PHPeclipse - PHP - Code Templates<br />*/<br />include(&quot;getmms.php&quot;);<br />//连接到数据库<br />$con = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;&quot;);<br />if (!$con)<br />{<br />die('Could not connect: ' . mysql_error());<br />}<br />//创建自己的数据库<br />mysql_query(&quot;drop DATABASE my_db&quot;,$con);<br />if (mysql_query(&quot;CREATE DATABASE my_db&quot;,$con))<br />{<br />echo &quot;Database created&quot;;<br />}<br />else<br />{<br />echo &quot;Error creating database: &quot; . mysql_error();<br />}<br />//创建表<br />mysql_select_db(&quot;my_db&quot;, $con);<br />mysql_query(&quot;drop table iptv&quot;,$con);<br />$sql = &quot;CREATE TABLE iptv <br />(<br />URL varchar(40),<br />NAME varchar(20)<br />)&quot;;<br />if(mysql_query($sql,$con))<br />{<br />echo &quot;Table created&quot;;<br />}<br />else<br />{<br />echo &quot;Error creating table: &quot; . mysql_error();<br />}<br />//插入数据<br />$matches=getmms();<br />mysql_select_db(&quot;my_db&quot;, $con);<br />for($i=0;$i&lt;count($matches[0]);$i++)<br />{<br /><br />$my_data=&quot;'&quot;.$matches[1][$i].&quot;','&quot;.$matches[2][$i].&quot;'&quot;;<br />//echo $my_data;<br />$sql=&quot;INSERT INTO iptv (URL,NAME) VALUES<br />($my_data)&quot;;<br />//echo $matches[1][$i].$matches[2][$i];<br />if (!mysql_query($sql,$con))<br />{<br />echo 'Error: ' . mysql_error();<br />}<br />else<br />{<br />//echo ($i+1).&quot;record added&quot;;<br />} <br />}<br /><br /><br />//查询<br />mysql_select_db(&quot;my_db&quot;, $con);<br /><br />$result = mysql_query(&quot;select * from iptv&quot;);<br />//var_dump(mysql_fetch_array($result));<br /><br />while($row = mysql_fetch_array($result))<br />{<br />echo $row['URL'].&quot; &quot;.$row['NAME'];<br />echo &quot;&lt;br /&gt;&quot;;<br />}<br /><br /><br /><br /><br /><br />mysql_close($con);<br />?&gt;<br /> </div>