<h2>好好学习天天向上</h2><br/><h1>vba+dom+xml</h1><hr/>
<div id=content class="content mod-cs-content text-content clearfix"> <p>Sub 访问菜单()<br />&nbsp;&nbsp;&nbsp; Dim mycontrol As Object<br />&nbsp;&nbsp;&nbsp; Dim i As Integer<br />&nbsp;&nbsp;&nbsp; For i = 1 To 10 Step 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set mycontrol = CommandBars(&quot;worksheet menu bar&quot;).Controls(i)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox mycontrol.Caption &amp; &quot;id is&quot; &amp; mycontrol.ID<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Next<br />&nbsp;&nbsp;&nbsp; For i = 1 To 9999 Step 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application.Speech.Speak &quot;hello, i love you!&quot;<br />&nbsp;&nbsp;&nbsp; Next<br />End Sub</p><p>Sub dom_xml()<br />&nbsp;&nbsp;&nbsp; Dim myxml As DOMDocument<br />&nbsp;&nbsp;&nbsp; Set myxml = New DOMDocument<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Dim myroot As IXMLDOMElement<br />&nbsp;&nbsp;&nbsp; Set myroot = myxml.createElement(&quot;myroot&quot;)<br />&nbsp;&nbsp;&nbsp; Set myxml.DocumentElement = myroot<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Dim tempnode As IXMLDOMNode<br />&nbsp;&nbsp;&nbsp; Set tempnode = myxml.createNode(NODE_ELEMENT, &quot;mynode&quot;, &quot;&quot;)<br />&nbsp;&nbsp;&nbsp; tempnode.Text = &quot;333&quot;<br />&nbsp;&nbsp;&nbsp; myroot.appendChild tempnode<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Dim tempelement As IXMLDOMElement<br />&nbsp;&nbsp;&nbsp; Dim tempatrribute As IXMLDOMElement<br />&nbsp;&nbsp;&nbsp; Set tempelement = tempnode<br />&nbsp;&nbsp;&nbsp; tempelement.setAttribute &quot;myattribute&quot;, 44<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; myxml.Save (&quot;c:\myxml.xml&quot;)<br />&nbsp;&nbsp;&nbsp; <br />End Sub<br /></p><p>&nbsp;</p><p>&nbsp;</p><p>Private Sub CommandButton1_Click()</p><p>End Sub</p><p>Private Sub 你好_Click()<br />&nbsp;&nbsp;&nbsp; Application.Speech.Speak &quot;hello&quot;<br />End Sub</p><p>Private Sub 再见_Click()<br />&nbsp;&nbsp;&nbsp; Application.Speech.Speak &quot;bye&quot;<br />End Sub</p> </div>