---
layout: post
title: screen自动ssh登录多个远程服务器
time: 2013-05-24 21:58
keywords: 好好学习天天向上
---
<div id=content class="content mod-cs-content text-content clearfix"> <pre class="brush: bash;toolbar:false;">function&nbsp;screenssh&nbsp;(){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;timeout=3&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;servers=&#39;&#39;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;$#&nbsp;-lt&nbsp;1&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;servers=&#39;1&nbsp;2&nbsp;3&nbsp;4&nbsp;5&nbsp;6&nbsp;7&nbsp;8&nbsp;9&#39;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;servers=$@&nbsp;&nbsp;&nbsp;&nbsp;fi&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;server&nbsp;in&nbsp;$servers;&nbsp;do&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp=$server&quot;_pjl&quot;$RANDOM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cp&nbsp;~/bin/ssh.sh&nbsp;~/bin/$tmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen&nbsp;-S&nbsp;$STY&nbsp;-X&nbsp;screen&nbsp;$tmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep&nbsp;$timeout&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd=&quot;screen&nbsp;-S&nbsp;$STY&nbsp;-X&nbsp;at&nbsp;$tmp#&nbsp;stuff&nbsp;$&#39;$password\n&#39;&quot;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval&nbsp;$cmd#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep&nbsp;$timeout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd=&quot;screen&nbsp;-S&nbsp;$STY&nbsp;-X&nbsp;at&nbsp;$tmp#&nbsp;stuff&nbsp;$&#39;ssh&nbsp;$server\n&#39;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval&nbsp;$cmd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rm&nbsp;~/bin/$tmp&nbsp;&nbsp;&nbsp;&nbsp;done}</pre><p>使用authorized_keys之类可以免去输入密码的步骤</p> </div>