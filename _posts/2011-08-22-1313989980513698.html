---
layout: post
title: MYSQL5.1手册3、4
time: 2011-08-22 13:13
keywords: 好好学习天天向上
---
<div id=content class="content mod-cs-content text-content clearfix"> <p><strong>第三章教程</strong></p><p><b></b></p><p><b>要想将文本文件“pet.txt”装载到pet表中，使用这个命令：&nbsp;</b></p><p><b>mysql&gt; LOAD DATA LOCAL INFILE '/path/pet.txt' INTO TABLE pet;&nbsp;</b></p><p></p><p><b>以下查询显示了每个宠物的出生日期、当前日期和年龄数值的年数&nbsp;</b></p><p><b>字。&nbsp;</b></p><p><b>mysql&gt; SELECT name, birth, CURDATE(),&nbsp;</b></p><p><b>&nbsp; -&gt; (YEAR(CURDATE())-YEAR(birth))&nbsp;</b></p><p><b>&nbsp; -&gt; - (RIGHT(CURDATE(),5)&lt;RIGHT(birth,5))&nbsp;</b></p><p><b>&nbsp; -&gt; AS age&nbsp;</b></p><p><b>&nbsp; -&gt; FROM pet;&nbsp;</b></p><p></p><p><b>对于那些非NULL值的动物，需要计算出death和birth值之间的差：&nbsp;</b></p><p><b>mysql&gt; SELECT name, birth, death,&nbsp;</b></p><p><b>&nbsp; -&gt; &nbsp;(YEAR(death)-YEAR(birth)) - (RIGHT(death,5)&lt;RIGHT(birth,5))&nbsp;</b></p><p><b>&nbsp; -&gt; AS age&nbsp;</b></p><p><b>&nbsp; -&gt; FROM pet WHERE death IS NOT NULL ORDER BY age;</b></p><p></p><p></p><b>DATE_ADD( )允许在一个给定的日期上加上时间间隔。如果在NOW( )值上加上一个&nbsp;</b><b>月，然后用MONTH()提取月份，结果产生生日所在月份：&nbsp;</b><b>mysql&gt; SELECT name, birth FROM pet&nbsp;</b><b>-&gt; WHERE MONTH(birth) = MONTH(DATE_ADD(CURDATE(),INTERVAL 1 MONTH));&nbsp;</b><b>在GROUP BY 中，两个NULL值视为相同。&nbsp;</b><b>执行ORDER BY时，如果运行 ORDER BY ... ASC，则NULL值出现在最前面，若运行ORDER BY ...&nbsp;</b><b>DESC，则NULL值出现在最后面。</b><b>要想找出以“b”开头的名字：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name LIKE 'b%';&nbsp;</b><b>要想找出以“fy”结尾的名字：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name LIKE '%fy';&nbsp;</b><b>要想找出包含“w”的名字：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name LIKE '%w%';&nbsp;</b><b>要想找出正好包含5个字符的名字，使用“_ ”模式字符：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name LIKE '_____';</b><b>由MySQL提供的模式匹配的其它类型是使用扩展正则表达式。当你对这类模式进行匹配测试时，&nbsp;</b><b>使用REGEXP和NOT REGEXP操作符(或RLIKE和NOT RLIKE，它们是同义词)。&nbsp;</b><b>为了找出以“b”开头的名字，使用“^”匹配名字的开始：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name REGEXP '^b';&nbsp;</b><b>该查询只匹配名称首字母的小写‘b ’。&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name REGEXP BINARY '^b';&nbsp;</b><b>为了找出以“fy”结尾的名字，使用“$”匹配名字的结尾：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name REGEXP 'fy$';&nbsp;</b><b>为了找出包含一个“w”的名字，使用以下查询：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name REGEXP 'w';&nbsp;</b><b>为了找出包含正好5个字符的名字，使用“^”和“$”匹配名字的开始和结尾，和5个“.”实例在两者&nbsp;</b><b>之间：&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name REGEXP '^.....$';&nbsp;</b><b>mysql&gt; SELECT * FROM pet WHERE name REGEXP '^.{5}$';&nbsp;</b><b>你已经见到了SHOW DATABASES，它列出由服务器管理的数据库。为了找出当前选择了哪个数&nbsp;</b><b>据库，使用DATABASE( )函数：&nbsp;</b><b>mysql&gt; SELECT DATABASE();&nbsp;</b><b>为了找出当前的数据库包含什么表(例如，当你不能确定一个表的名字)，使用这个命令：&nbsp;</b><b>mysql&gt; SHOW TABLES;&nbsp;</b><b>mysql&gt; DESCRIBE pet;</b><b>如果表有索引，SHOW INDEX FROM tbl_name生成有关索引的信息。</b><b>如果你需要在命令行上指定连接参数，命令应为：&nbsp;</b><b>shell&gt; mysql -h host -u user -p &lt; batch-file&nbsp;</b><b>Enter password: ********&nbsp;</b><b>你还可以使用源代码或 \.命令从mysql提示符运行脚本：&nbsp;</b><b>mysql&gt; source filename;&nbsp;</b><b>mysql&gt; \. filename&nbsp;</b><b>拥有某个列的最大值的行&nbsp;</b><b>任务：找出最贵物品的编号、销售商和价格。&nbsp;</b><b>这很容易用一个子查询做到：&nbsp;</b><b>SELECT article, dealer, price&nbsp;</b><b>FROM &nbsp; &nbsp;shop&nbsp;</b><p><b>WHERE &nbsp; &nbsp;price=(SELECT MAX(price) FROM shop);&nbsp;</b></p><p><b>拥有某个字段的组间最大值的行任务：对每项物品，找出最贵价格的物品的经销商。&nbsp;</b><b>可以用这样一个子查询解决该问题：&nbsp;</b></p><p><b>SELECT article, dealer, price&nbsp;</b></p><p><b>FROM &nbsp; &nbsp;shop s1&nbsp;</b></p><p><b>WHERE &nbsp; &nbsp;price=(SELECT MAX(s2.price)&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; FROM shop s2&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; WHERE s1.article = s2.article);</b></p><p><b></b></p><p><b>使用用户变量，</b><b>例如，要找出价格最高或最低的物品的，其方法是：&nbsp;</b></p><p><b>mysql&gt; SELECT @min_price:=MIN(price),@max_price:=MAX(price) FROM shop;&nbsp;</b></p><p><b>mysql&gt; SELECT * FROM shop WHERE price=@min_price OR price=@max_price;&nbsp;</b></p><p><b></b></p><p><b>示例表中含有代表用户访问网页的年－月－日值。可以使用以下查询来确定每个月的访问天数：&nbsp;</b></p><p><b>SELECT year,month,BIT_COUNT(BIT_OR(1&lt;&lt;day)) AS days FROM t1&nbsp;</b></p><p><b>&nbsp; &nbsp;GROUP BY year,month;&nbsp;</b></p><p></p><p><b>要想以AUTO_INCREMENT值开始而不是1，你可以通过CREATE TABLE或ALTER TABLE来设置该值，&nbsp;</b></p><p></p><p><b>mysql&gt; ALTER TABLE tbl AUTO_INCREMENT = 100;&nbsp;</b></p><p></p><strong>第4章MySQL程序概述</strong><p></p><p><b></b></p><p></p><p></p><p><b>· &nbsp; &nbsp;MYSQL服务器和服务器启动脚本：&nbsp;</b></p><p><b><br /></b></p><p><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;o &nbsp; &nbsp; &nbsp; mysqld是MySQL服务器&nbsp;</b></p><p><b><br /></b></p><p><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;o &nbsp; &nbsp; &nbsp; mysqld_safe、mysql.server和mysqld_multi是服务器启动脚本&nbsp;</b></p><p><b><br /></b></p><p><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;o &nbsp; &nbsp; &nbsp; mysql_install_db初始化数据目录和初始数据库</b></p><p><b></b></p><p><b>· &nbsp; &nbsp;访问服务器的客户程序：&nbsp;</b></p><p><b>&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;o &nbsp; &nbsp; &nbsp; mysql是一个命令行客户程序，用于交互式或以批处理模式执行SQL语句。&nbsp;</b></p><p><b>以破折号开始的参数为选项参量。它们通常指定程序与服务器的连接类型或影响其操作模式。部分选项对部分程序是通用的。最常用的是指定连接参数的--host、--user和--password选项。</b><b>选项参量以一个和两个破折号开始，取决于它具有短名还是长名。许多选项有两种形式。例如，-?和--help&nbsp;</b><b>是指导MySQL程序显示帮助消息的选项的短名和长名。选项名对大小写敏感。-v和-V均有效，但具有不同的含义。(它们是--verbose和--version选项的短名）。</b><b>&nbsp;对于带选项值的长选项，通过一个‘= ’将选项名和值隔离开来。对于带选项值的短选项，选项值可以紧随</b><b>选项字母后面，或者二者之间可以用一个空格隔开。(-hlocalhost和-h localhost是等效的）。该规则的例外情况是指定&nbsp;</b><b>MySQL密码的选项。</b></p><p><b>要想禁用列名，可以使用下面的形式来指定选项：&nbsp;</b></p><p><b>--disable-column-names&nbsp;</b></p><p><b>--skip-column-names&nbsp;</b></p><p><b>--column-names=0&nbsp;</b></p><p><b>--disable和--skip前缀与=0后缀的效果相同：它们均关闭选项。&nbsp;</b></p><p><b>可以用下述方法“启用”选项：&nbsp;</b></p><p><b>--column-names&nbsp;</b></p><p><b>--enable-column-names&nbsp;</b></p><p><b>--column-names=1&nbsp;</b></p><p><b>你可以用下面的命令获得用户账户列表：&nbsp;</b></p><p><b></b></p><p><b>shell&gt; mysql -u root -p -e &quot;SELECT User, Host FROM User&quot; mysql&nbsp;</b></p><p><b>Enter password: ******&nbsp;</b></p><p></p><p><b>下面的程序支持选项文件：myisamchk、myisampack、mysql、mysql.server、mysqladmin、mysqlbinlog、mysqlcc、&nbsp;</b></p><p><b>mysqlcheck、mysqld_safe、mysqldump、mysqld、mysqlhotcopy、mysqlimport和mysqlshow。</b></p><p></p><p><b>在Unix中，MySQL程序从下面的文件读取启动选项：&nbsp;</b></p><p><b>&nbsp;文件名 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 目的&nbsp;</b></p><p><b>&nbsp;/etc/my.cnf &nbsp; &nbsp; &nbsp;全局选项&nbsp;</b></p><p><b>&nbsp;$MYSQL_HOME/my.cnf 服务器相关选项&nbsp;</b></p><p><b>&nbsp;defaults-extra-file 用--defaults-extra-file=path指定的文件，如果有&nbsp;</b></p><p><b>&nbsp;~/.my.cnf &nbsp; &nbsp; &nbsp; &nbsp;用户相关选项&nbsp;</b></p><p><b>选项文件中的空行被忽略掉。非空行可以采用下面任何形式：</b></p><p><b></b></p><p><b>· &nbsp; &nbsp;#注释 ，；注释&nbsp;</b><b>注释行以‘# ’或‘；’开头。‘# ’注释也可以从行的中部开始。&nbsp;</b></p><p><b>· &nbsp; &nbsp; [group]&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; group是你想要设置选项的程序名或组名。在组行后面，任何opt_name或set-variable行适用于组名，直到选项&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; 文件结尾或给出其它组行。&nbsp;</b></p><p><b>· &nbsp; &nbsp;opt_name&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; 等价于命令行中的--opt_name 。&nbsp;</b></p><p><b>· &nbsp; &nbsp;opt_name=value&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; 等价于命令行中的--opt_name=value 。在选项文件中，‘= ’字符附近可以有空格，而在命令行中是不允许&nbsp;</b></p><p><b>&nbsp; &nbsp; &nbsp; 的。你可以用单引号或双引号来引用值。如果值包含一个‘# ’注释字符或空格时很有用。&nbsp;</b></p><b>下面是一个典型的全局选项文件：&nbsp;<br />[client]&nbsp;port=3306&nbsp;socket=/tmp/mysql.sock&nbsp;<br />[mysqld]&nbsp;port=3306&nbsp;socket=/tmp/mysql.sock&nbsp;key_buffer_size=16M&nbsp;max_allowed_packet=8M&nbsp;<br />[mysqldump]&nbsp;<p>quick&nbsp;</p><p><p>下面是一个典型的用户选项文件：&nbsp;</p><p>&nbsp;</p><p>[client]&nbsp;</p><p># The following password will be sent to all standard MySQL clients&nbsp;</p><p>password=&quot;my_password&quot;&nbsp;</p><p>&nbsp;</p><p>[mysql]&nbsp;</p><p>no-auto-rehash&nbsp;</p><p>connect_timeout=2&nbsp;</p><p>&nbsp;</p><p>[mysqlhotcopy]&nbsp;</p><p>interactive-timeout&nbsp;</p></p></b><p></p><p><b>注释：在Unix平台上，MySQL忽略人人可写的配置文件。这是故意的，是一个安全措施。</b></p><p></p><p></p><p></p><p><b></b></p><p><b>非选项参数(不以破折号开始的参量)可以为程序提供更详细的信息。例如，mysql程序将第一个非选项参量解释为</b></p><b><p>数据库名，因此命令 mysql test表示你想要使用test数据库。</p></b><p></p><b><p></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;o &nbsp; &nbsp; &nbsp; mysqladmin是用于管理功能的客户程序。</p><p></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;o &nbsp; &nbsp; &nbsp; mysqlcheck执行表维护操作。&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o &nbsp; &nbsp; &nbsp; mysqldump和mysqlhotcopy负责数据库备份。&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o &nbsp; &nbsp; &nbsp; mysqlimport导入数据文件。&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o &nbsp; &nbsp; &nbsp; mysqlshow显示信息数据库和表的相关信息。&nbsp;</p><p></p><p>· &nbsp; &nbsp;独立于服务器操作的工具程序：&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o &nbsp; &nbsp; &nbsp; myisamchk执行表维护操作。&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o &nbsp; &nbsp; &nbsp; myisampack产生压缩、只读的表。&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o &nbsp; &nbsp; &nbsp; mysqlbinlog是处理二进制日志文件的实用工具。&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o &nbsp; &nbsp; &nbsp; &nbsp;perror显示错误代码的含义。</p><p></p><p></p><p></p><p></p><p></p></b><p></p><p></p><p></p><p></p> </div>