---
layout: post
title: excel常用对象 VBA开发
time: 2011-06-23 15:49
tags: 好好学习天天向上
---

<div id=content class="content mod-cs-content text-content clearfix"> <p>Public Function add(a As Integer, b As Integer)<br />&nbsp;&nbsp;&nbsp; Dim c As Integer<br />&nbsp;&nbsp;&nbsp; c = a + b<br />&nbsp;&nbsp;&nbsp; add = c<br />End Function<br />Sub 第一个vba程序()<br />&nbsp;&nbsp;&nbsp; Dim title As String<br />&nbsp;&nbsp;&nbsp; Dim content As String<br />&nbsp;&nbsp;&nbsp; title = &quot;hello&quot;<br />&nbsp;&nbsp;&nbsp; content = &quot;world&quot;<br />&nbsp;&nbsp;&nbsp; Debug.Print &quot;title=&quot; &amp; title<br />&nbsp;&nbsp;&nbsp; Debug.Print &quot;content=&quot; &amp; content<br />&nbsp;&nbsp;&nbsp; MsgBox content, vbOKOnly, title<br />&nbsp;&nbsp;&nbsp; MsgBox add(1, 6), vbOKOnly, &quot;add_result&quot;<br />&nbsp;&nbsp;&nbsp; <br />End Sub<br />Sub 设置文字格式()<br />'<br />' 设置文字格式 宏<br />' 楷体，红色，18<br />'</p><p>'<br />&nbsp;&nbsp;&nbsp; With Selection.Font<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Name = &quot;楷体&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .FontStyle = &quot;常规&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Size = 18<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Strikethrough = False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Superscript = False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Subscript = False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .OutlineFont = False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Shadow = False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Underline = xlUnderlineStyleNone<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Color = 255<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .TintAndShade = 0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .ThemeFont = xlThemeFontNone<br />&nbsp;&nbsp;&nbsp; End With<br />End Sub<br />Sub 判断闰年()<br />&nbsp;&nbsp;&nbsp; Dim year As Integer<br />&nbsp;&nbsp;&nbsp; year = CInt(InputBox(&quot;请输入需要判断的年份&quot;, &quot;判断闰年&quot;, 2011))<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; If year Mod 4 = 0 And year Mod 100 &lt;&gt; 0 Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox &quot;&quot; &amp; year &amp; &quot;是闰年&quot;, vbOKOnly, &quot;判断结果&quot;<br />&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If year Mod 400 = 0 Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox &quot;&quot; &amp; year &amp; &quot;是闰年&quot;, vbOKOnly, &quot;判断结果&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox &quot;&quot; &amp; year &amp; &quot;不是闰年&quot;, vbOKOnly, &quot;判断结果&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp; End If<br />End Sub<br />&nbsp;</p><p><br />Sub 当前工作簿名称()<br />Dim wbs As Workbooks<br />Set wbs = Application.Workbooks</p><p>For Each temp In wbs<br />&nbsp;&nbsp;&nbsp; MsgBox temp.Name, vbOKOnly, &quot;hello&quot;<br />Next</p><p>End Sub</p><p>Sub 激活单元格()<br />&nbsp;&nbsp;&nbsp; Worksheets(&quot;sheet1&quot;).Activate<br />&nbsp;&nbsp;&nbsp; With ActiveCell<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Value = &quot;中国&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With .Font<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Bold = True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Italic = True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Size = 32<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With<br />&nbsp;&nbsp;&nbsp; End With<br />End Sub<br />Sub 更改标题()<br />&nbsp;&nbsp;&nbsp; Application.Caption = &quot;龙哥的excel&quot;<br />End Sub<br />Sub 选定range()<br />&nbsp;&nbsp;&nbsp; Worksheets(&quot;sheet1&quot;).Range(&quot;A1&quot;).Value = 8<br />&nbsp;&nbsp;&nbsp; Dim ran As Range<br />&nbsp;&nbsp;&nbsp; Set ran = Worksheets(&quot;sheet1&quot;).Range(Cells(1, 1), Cells(6, 6))<br />&nbsp;&nbsp;&nbsp; ran.Activate<br />&nbsp;&nbsp;&nbsp; With ran.Borders(xlInsideHorizontal)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Color = RGB(255, 0, 0)<br />&nbsp;&nbsp;&nbsp; End With<br />&nbsp;&nbsp;&nbsp; For Each c In ran<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MsgBox c.Value &amp; &quot;///&quot; &amp; c.Text, vbOKOnly, &quot;out&quot;<br />&nbsp;&nbsp;&nbsp; Next<br />End Sub<br />Sub 设置边框()<br />&nbsp;&nbsp;&nbsp; Dim wk As Workbook<br />&nbsp;&nbsp;&nbsp; Dim wt As Worksheet<br />&nbsp;&nbsp;&nbsp; Dim ran As Range<br />&nbsp;&nbsp;&nbsp; Dim brd As Borders<br />&nbsp;&nbsp;&nbsp; Dim mypath As String<br />&nbsp;&nbsp;&nbsp; Dim fullpath As String<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Set wk = Workbooks(1)<br />&nbsp;&nbsp;&nbsp; mypath = wk.Path<br />&nbsp;&nbsp;&nbsp; fullpath = mypath + &quot;\&quot; + &quot;66.xlsm&quot;<br />&nbsp;&nbsp;&nbsp; Set wk = Workbooks.Open(fullpath)<br />&nbsp;&nbsp;&nbsp; Set wt = wk.Worksheets(&quot;sheet1&quot;)<br />&nbsp;&nbsp;&nbsp; wt.Activate<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Set ran = wt.UsedRange<br />&nbsp;&nbsp;&nbsp; Set brd = ran.Borders<br />&nbsp;&nbsp;&nbsp; For i = xlEdgeLeft To xlInsideHorizontal<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With brd(i)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .LineStyle = xlDouble<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Weight = xlThick<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Color = RGB(0, 0, 255)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With<br />&nbsp;&nbsp;&nbsp; Next<br />&nbsp;&nbsp;&nbsp; MsgBox &quot;设置边框完成！&quot;, vbOKOnly, &quot;设置边框样式&quot;<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Dim inte As Interior<br />&nbsp;&nbsp;&nbsp; Set inte = ran.Interior<br />&nbsp;&nbsp;&nbsp; With inte<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Pattern = xlPatternCrissCross<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .PatternColor = RGB(0, 255, 0)<br />&nbsp;&nbsp;&nbsp; End With<br />&nbsp;&nbsp;&nbsp; MsgBox &quot;设置底色成功！&quot;, vbOKOnly, &quot;设置单元格背景&quot;<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; ran.Merge<br />&nbsp;&nbsp;&nbsp; MsgBox &quot;range.merge！&quot;, vbOKOnly, &quot;合并单元格&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; Set wk = Nothing<br />&nbsp;&nbsp;&nbsp; Set wt = Nothing<br />&nbsp;&nbsp;&nbsp; Set ran = Nothing<br />&nbsp;&nbsp;&nbsp; Set brd = Nothing<br />&nbsp;&nbsp;&nbsp; Set inte = Nothing<br />End Sub<br /></p> </div>